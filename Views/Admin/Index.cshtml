<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
@model Tuple<List<CapstoneWine.Models.SubscriptionsModel>, List<CapstoneWine.Models.WinesModel>, List<CapstoneWine.Models.OrdersModel>, List<CapstoneWine.Models.CustomerModel>>

@{
	ViewData["Title"] = "Admin";
	var userCountStr = ViewData["UserCount"].ToString();
	int userCount = Convert.ToInt32(userCountStr);

	var wineCountStr = ViewData["WineCount"].ToString();
	int wineCount = Convert.ToInt32(wineCountStr);

	var adminCountStr = ViewData["AdminCount"].ToString();
	int adminCount = Convert.ToInt32(adminCountStr);

	var pendingOrdersStr = ViewData["pendingOrders"].ToString();
	int pendingOrders = Convert.ToInt32(pendingOrdersStr);

}

<style>

	a {
		color: white;
	}

	.fs-big {
		font-size: 1.3rem;
	}

	.navbar {
		background-color: var(--bg-color);
	}

	.dashboard {
		width: 100%;
		display: grid;
		grid-template-columns: 250px 1fr;
		/*background-color: var(--accent-color);*/
	}

	.sidebar {
		position: relative;
		left: 0;
		min-height: calc(100vh - 70px);
		padding: 1rem;
		border-right: 1px solid darkblue;
		/*background-color: rgba(200, 200, 200, 0.5);*/
	}

	.menu-area {
		display: grid;
		gap: 0.3rem;
		margin-bottom: 2rem;
		font-weight: bold;
		position: relative;
	}

		.menu-area::after {
			content: '';
			position: absolute;
			top: calc(100% + 20px);
			width: 100%;
			height: 1px;
			background-color: rgba(200, 200, 200, 0.12);
		}

	.menu-link {
		height: 2.3rem;
		position: relative;
		font-weight: normal;
	}

		.menu-link::after {
			content: '>';
			position: absolute;
			right: 0;
		}

	.content {
		position: relative;
		padding: 1rem;
		/*background-color: rgba(200, 200, 200, 0.7);*/
	}

	.top-wrapper, .mid-wrapper, .bottom-wrapper {
		width: 100%;
		display: grid;
		gap: 1.67rem;
		margin: 1.67rem 0;
		/*background-color: white;*/
	}

	.top-wrapper {
		grid-template-columns: repeat(4, 1fr);
	}

	.info-tab {
		--tab-color: rgb(23,87,201);
		position: relative;
		display: grid;
		grid-template-columns: 7fr 2fr;
		grid-template-rows: auto auto;
		column-gap: 5px;
		color: var(--tab-color);
		border-radius: 10px;
		padding: 20px 15px;
		overflow: hidden;
		background-color: rgba(200, 200, 200, 0.2);
	}

		.info-tab::before {
			content: '';
			position: absolute;
			inset: 0;
			width: 5px;
			height: 100%;
			background-color: var(--tab-color);
		}

		.info-tab:nth-child(2) {
			--tab-color: rgb(0,171,169);
		}

		.info-tab:nth-child(3) {
			--tab-color: rgb(185,29,71);
		}

		.info-tab:nth-child(4) {
			--tab-color: coral;
		}

	.tab-title {
		grid-row-start: 1;
		font-size: 1.115rem;
	}

	.tab-value {
		grid-row-start: 2;
		color: white;
	}

	.tab-icon {
		grid-column-start: 2;
		grid-row: span 2;
		place-self: center;
		width: 100%;
		height: 100%;
	}

		.tab-icon img {
			width: 100%;
			object-fit: contain;
		}

	.mid-wrapper {
		grid-template-columns: 6fr 4fr;
	}

	.sales-chart {
		/*background-color: pink;*/
		background-color: rgba(200, 200, 200, 0.2);
		border-radius: 10px;
	}

	.user-pie-graph {
		/*background-color: pink;*/
		background-color: rgba(200, 200, 200, 0.2);
		border-radius: 10px;
		width: 100%;
	}

	.bottom-wrapper {
		/*background-color: pink;*/
		padding: 1.67rem;
		gap: 0.5rem;
		border-radius: 10px;
		background-color: rgba(200, 200, 200, 0.2);
	}

	.user-row {
		display: grid;
		grid-template-columns: repeat(5, 1fr);
		padding: 10px 20px;
		border-radius: 100px;
		background-color: var(--blue);
		/*background-color: rgba(10, 10, 10, 0.1);*/
	}

		.user-row:nth-child(2n-1) {
			background-color: rgba(13, 110, 253, 0.33);
		}

		.user-row:nth-child(3), .user-row:nth-child(4) {
			border-radius: unset;
		}

		.user-row:nth-child(5) {
			border-radius: 0 0 10px 10px;
		}

	.header {
		border-radius: 20px 20px 0 0;
		background-color: rgba(13, 110, 253, 0.63);
	}

	.link {
		opacity: 0.5;
	}

		.link:hover {
			opacity: 1;
		}

</style>




<section class="dashboard">

	<section class="sidebar">
		<div class="menu-area fs-big">Hello Admin</div>
		<a><div class="menu-area">Dashboard</div></a>
		<div class="menu-area">
			<a asp-controller="Orders" asp-action="Index"><div class="menu-link">Orders</div></a>
			<a asp-controller="Subscriptions" asp-action="Index"><div class="menu-link">Subscriptions</div></a>
			<a asp-controller="Wines" asp-action="Index"><div class="menu-link">Wines</div></a>
			<a asp-controller="Customer" asp-action="Index"><div class="menu-link">Customers</div></a>
		</div>

	</section>

	<section class="content">
		<h5>Dashboard</h5>
		<div class="top-wrapper">
			<div class="info-tab">
				<span class="tab-title">Earnings (Monthly)</span>
				<span class="tab-value">$800.00</span>
				<i class="tab-icon"><img src="~/Images/dollar-symbol.png" /></i>
			</div>
			<div class="info-tab">
				<span class="tab-title">Earnings (Weekly)</span>
				<span class="tab-value">$200.00</span>
				<i class="tab-icon"><img src="/Images/dollar-symbol.png" /></i>
			</div>
			<div class="info-tab">
				<span class="tab-title">Users</span>
				<span class="tab-value">@userCount</span>
				<i class="tab-icon"><img src="/Images/user.png" /></i>
			</div>
			<div class="info-tab">
				<span class="tab-title">Pending Orders</span>
				<span class="tab-value">@pendingOrders</span>
				<i class="tab-icon"><img src="~/Images/order.png" /></i>
			</div>
		</div>

		<div class="mid-wrapper">
			<div class="sales-chart">
				<canvas id="salesChart"></canvas>
			</div>
			<div class="user-pie-graph">
				<canvas id="userPieChart" style="width: 100%; max-width: 400px;"></canvas>
			</div>
		</div>


		<div class="bottom-wrapper">
			<h5>Users</h5>
			<div class="user-row header">
				<div class="user-col">First Name</div>
				<div class="user-col">Last Name</div>
				<div class="user-col">City</div>
				<div class="user-col">Suburb</div>
				<div class="user-col">Street Address</div>
			</div>
			@foreach (var user in Model.Item4.Take(3))
			{
				<div class="user-row">
					<div class="user-col">@user.FirstName</div>
					<div class="user-col">@user.LastName</div>
					<div class="user-col">@user.City</div>
					<div class="user-col">@user.Suburb</div>
					<div class="user-col">@user.StreetAddress</div>
				</div>
			}
			<a asp-controller="Customer" asp-action="Index" class="link">See more...</a>
		</div>

	</section>

</section>







<script>
	function showSubscriptionsTable() {
		document.getElementById("subscriptionsTable").style.display = "block";
		document.getElementById("winesTable").style.display = "none";
		document.getElementById("ordersTable").style.display = "none";
	}

	function showWinesTable() {
		document.getElementById("subscriptionsTable").style.display = "none";
		document.getElementById("winesTable").style.display = "block";
		document.getElementById("ordersTable").style.display = "none";
	}

	function showOrdersTable() {
		document.getElementById("subscriptionsTable").style.display = "none";
		document.getElementById("winesTable").style.display = "none";
		document.getElementById("ordersTable").style.display = "block";
	}

	// User Pie Chart //
	var userTypes = ["Registered", "Subscribed", "Admin"];
	var typeCount = [@userCount, 2, @adminCount];
	var barColors = [
		"#b91d47",
		"#00aba9",
		"#2b5797"
	];

	new Chart("userPieChart", {
		type: "doughnut",
		data: {
			labels: userTypes,
			datasets: [{
				backgroundColor: barColors,
				data: typeCount
			}]
		},
		options: {
			title: {
				display: true,
				text: "All Users"
			}
		}
	});




	// Sales Line Graph
	const weeks = [1, 2, 3, 4, 5, 6, 7, 8];
	const salesNum = [10, 30, 10, 30, 50, 60, 60, 80];

	new Chart("salesChart", {
		type: "line",
		data: {
			labels: weeks, // x-axis
			datasets: [{
				fill: false,
				lineTension: 0,
				backgroundColor: "rgba(0,0,255,1.0)",
				borderColor: "rgba(0,0,255,0.1)",
				data: salesNum  // y-axis
			}]
		},
		options: {
			legend: { display: false },
			scales: {
				yAxes: [{
					ticks: { min: 0, max: 90 },
					scaleLabel: {
						display: true,
						labelString: "Sales Amount" // y-axis title
					}
				}],
				xAxes: [{
					scaleLabel: {
						display: true,
						labelString: "Weeks" // x-axis title
					}
				}]
			},
			title: {
				display: true,
				text: "Sales per week"
			}
		}
	});




</script>