<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
@model Tuple<List<CapstoneWine.Models.SubscriptionsModel>, List<CapstoneWine.Models.WinesModel>, List<CapstoneWine.Models.OrdersModel>, List<CapstoneWine.Models.CustomerModel>>

@{
	ViewData["Title"] = "Admin";
	var userCountStr = ViewData["UserCount"].ToString();
	int userCount = Convert.ToInt32(userCountStr);

	var wineCountStr = ViewData["WineCount"].ToString();
	int wineCount = Convert.ToInt32(wineCountStr);

	var adminCountStr = ViewData["AdminCount"].ToString();
	int adminCount = Convert.ToInt32(adminCountStr);

	var pendingOrdersStr = ViewData["pendingOrders"].ToString();
	int pendingOrders = Convert.ToInt32(pendingOrdersStr);

}

<style>
	/* Basic styling */
	body {
		font-family: Arial, sans-serif;
	}

	.table {
		color: white;
	}

	#dashboard {
		display: grid;
		grid-template-columns: 200px 1fr; /* Sidebar width and content width */
		gap: 20px; /* Gap between sidebar and content */
	}

	#sidebar {
		background: #333;
		color: #fff;
		padding: 20px;
		box-sizing: border-box;
	}

		#sidebar ul {
			list-style: none;
			padding: 0;
			margin: 0;
		}

			#sidebar ul li {
				margin-bottom: 10px;
			}

				#sidebar ul li a {
					color: #fff;
					text-decoration: none;
					display: block;
				}

	#content {
		padding: 20px;
		box-sizing: border-box;
	}

</style>

<script>
	function showSubscriptionsTable() {
		document.getElementById("subscriptionsTable").style.display = "block";
		document.getElementById("winesTable").style.display = "none";
		document.getElementById("ordersTable").style.display = "none";
	}

	function showWinesTable() {
		document.getElementById("subscriptionsTable").style.display = "none";
		document.getElementById("winesTable").style.display = "block";
		document.getElementById("ordersTable").style.display = "none";
	}

	function showOrdersTable() {
		document.getElementById("subscriptionsTable").style.display = "none";
		document.getElementById("winesTable").style.display = "none";
		document.getElementById("ordersTable").style.display = "block";
	}

	// User Pie Chart //
	var userTypes = ["Registered", "Subscribed", "Admin"];
	var typeCount = [@userCount, 2, @adminCount];
	var barColors = [
		"#b91d47",
		"#00aba9",
		"#2b5797"
	];

	new Chart("userPieChart", {
		type: "doughnut",
		data: {
			labels: userTypes,
			datasets: [{
				backgroundColor: barColors,
				data: typeCount
			}]
		},
		options: {
			title: {
				display: true,
				text: "All Users"
			}
		}
	});




	// Sales Line Graph
	const weeks = [1, 2, 3, 4, 5, 6, 7, 8];
	const salesNum = [10, 30, 10, 30, 50, 60, 60, 80];

	new Chart("salesChart", {
		type: "line",
		data: {
			labels: weeks, // x-axis
			datasets: [{
				fill: false,
				lineTension: 0,
				backgroundColor: "rgba(0,0,255,1.0)",
				borderColor: "rgba(0,0,255,0.1)",
				data: salesNum  // y-axis
			}]
		},
		options: {
			legend: { display: false },
			scales: {
				yAxes: [{
					ticks: { min: 0, max: 90 },
					scaleLabel: {
						display: true,
						labelString: "Sales Amount" // y-axis title
					}
				}],
				xAxes: [{
					scaleLabel: {
						display: true,
						labelString: "Weeks" // x-axis title
					}
				}]
			},
			title: {
				display: true,
				text: "Sales per week"
			}
		}
	});




</script>


<div id="dashboard">
	<div id="sidebar">
		<ul>
			<li><a onclick="showOrdersTable()">Orders</a></li>
			<li><a onclick="showSubscriptionsTable()">Subscriptions</a></li>
			<li><a onclick="showWinesTable()">Wines</a></li>
		</ul>
	</div>
	@*<h1>Welcome to the Admin Dashboard</h1>*@
	<div id="content">

		<!-- Content for the "Subscriptions" section -->
		<div id="subscriptionsTable" style="display: none;">
			<!-- Subscriptions table -->
			<div class="row">
				<div class="col-12">
					<a asp-controller="Subscriptions" asp-action="Index"><h3>Subscriptions</h3></a>
				</div>
			</div>

			<div class="row">
				<div class="col-12 pe-5">
					<table class="table">
						<thead>
							<tr>
								<th>ID</th>
								<th>Name</th>
								<th>Type</th>
								<th>Frequency</th>
								<th>Number of Bottles</th>
								<th>Reward Points</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var subscription in Model.Item1)
							{
								<tr>
									<td>@subscription.SubID</td>
									<td>@subscription.SubName</td>
									<td>@subscription.Type</td>
									<td>@subscription.Frequency</td>
									<td>@subscription.NumOfBottles</td>
									<td>@subscription.RewardPoints</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<!-- Content for the "Wines" section -->
		<div id="winesTable" style="display: none;">
			<div class="row">
				<div class="col-12">
					<a asp-controller="Wines" asp-action="Index"><h3>Wines</h3></a>
				</div>
			</div>

			<div class="row">
				<div class="col-12 pe-5">
					<table class="table">
						<thead>
							<tr>
								<th>ID</th>
								<th>Name</th>
								<th>Image</th>
								<th>Price</th>
								<th>Blurb</th>
								<th>Quantity</th>
								<th>Type</th>
								<th>Category</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var wine in Model.Item2)
							{
								<tr>
									<td>@wine.WineID</td>
									<td>@wine.WineName</td>
									<td>@wine.Image</td>
									<td>@wine.Price</td>
									<td>@wine.Blurb</td>
									<td>@wine.Quantity</td>
									<td>@wine.Type</td>
									<td>@wine.Category</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>


		<!-- Content for the orders table -->
		<div id="ordersTable" style="display: none;">
			<div class="row">
				<div class="col-12">
					<a asp-controller="Orders" asp-action="Index"><h3>Orders</h3></a>
				</div>
			</div>

			<div class="row">
				<div class="col-12 pe-5">
					<table class="table">
						<thead>
							<tr>
								<th>ID</th>
								<th>Order Date</th>
								<th>User ID</th>
								<th>Wine ID</th>
								<th>Subscription ID</th>
								<th>Quantity</th>
								<th>Delivery Address</th>
								<th>Delivery Charge</th>
								<th>Total Cost</th>
								<th>Order Status</th>
								<th>Reward Points</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var order in Model.Item3)
							{
								<tr>
									<td>@order.OrderID</td>
									<td>@order.OrderDate</td>
									<td>@order.CustomerId</td>
									<td>@order.WineID</td>
									<td>@order.SubID</td>
									<td>@order.Quantity</td>
									<td>@order.DeliveryAdd</td>
									<td>@order.DeliveryCharge</td>
									<td>@order.TotalCost</td>
									<td>@order.OrderStatus</td>
									<td>@order.RewardPoints</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>